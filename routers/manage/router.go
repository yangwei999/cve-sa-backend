package routers

import (
	"net/http"

	controllers "cve-sa-backend/controllers/manage"

	"github.com/gin-gonic/gin"
)

func ManageRouters(r *gin.Engine) {

	r.LoadHTMLGlob("./webapp/*")
	manager := r.Group("/cve-security-notice-server")
	{
		manager.GET("/refresh", controllers.Refresh)
		manager.GET("/manager", func(context *gin.Context) {
			context.HTML(http.StatusOK, "manager.html", nil)
		})
		manager.Use(managerAuth)
		manager.POST("/deleteCVE", controllers.DeleteCVE)
		manager.POST("/deleteSA", controllers.DeleteSA)
		manager.POST("/syncUnCVE", controllers.SyncCve)
		manager.POST("/getSyncCVE", controllers.GetHttpParserBeanListByCve)

		manager.POST("/syncHardware", controllers.SyncHardwareCompatibility)
		manager.POST("/syncDriver", controllers.SyncDriverCompatibility)
		manager.POST("/transfer", controllers.TransferOldData)
		manager.POST("/syncAll", controllers.SyncAll)
		manager.POST("/syncSA", controllers.SyncSA)
		manager.POST("/syncOsv", controllers.SyncOsv)
		manager.POST("/generateXml", controllers.GenerateXml)
		manager.POST("/inspectionXml", controllers.InspectionXml)
	}
}
